<html>
<head>
  <title>JD-asm</title>
</head>
<body onload="init();" onresize="sc();">
<script type="text/javascript" src="swingIO/UI.js"></script>
<script>
  /*------------------------------------------------------------
  This is a web based version of JDisassembly originally designed to run in Java.
  See https://github.com/Recoskie/JDisassembly/blob/master/app.java
  ------------------------------------------------------------*/
  
  var file = null, fr = new FileReader();
  var offset = null;
  
  function init()
  {
    offset = new VHex("vhex", false, sc);
    
    offset.hide(true);
  }
  
  function Open( f )
  {
    file = f.files[0];
    
    offset.hide(false); show("c1");
    
    offset.setSize(file.size);
    
    fr.readAsArrayBuffer(file.slice(0, offset.getRows() * 16));
  }
  
  function show( el )
  {
    document.getElementById(el).style.display = "";
  }
  
  function sc()
  {
    var pos = offset.getPos(); pos = (pos < 0 ? 0 : pos) * 16;
    var row = offset.getRows() * 16;
    
    fr.readAsArrayBuffer(file.slice(pos, pos + row));
  }
  
  fr.onload = function()
  {
    var data = new Uint8Array(fr.result);
    
    offset.update( data );
  }
        
  fr.onerror = function() { alert("error"); }
</script>
<input type="file" id="file" onchange="Open(this);"><input type="button" id="c1" value="Hide text" onclick="if(offset.text){offset.setText(false);this.value='Show text';}else{offset.setText(true);this.value='Hide text';}sc();" style="display:none;">
<iframe style='width:100%;height:100%;' id="vhex"></iframe>
</body>
</html>