<html>
<head>
  <title>JD-asm</title>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <meta name="apple-mobile-web-app-title" content="JD-asm">
  <link rel="apple-touch-icon" href="https://repository-images.githubusercontent.com/24021024/5e678080-0cfe-11eb-9edf-294da025f0c1">
  <meta property="og:image" content="https://repository-images.githubusercontent.com/24021024/5e678080-0cfe-11eb-9edf-294da025f0c1" />
</head>
<body onload="init();" onresize="offset.adjSize();virtual.adjSize();offset.update(file);virtual.update(file);">
<script type="text/javascript" src="swingIO/UI.js"></script>
<script type="text/javascript" src="RandomAccessFileV/FileReaderV.js"></script>
<script>
  /*------------------------------------------------------------
  This is a web based version of JDisassembly originally designed to run in Java.
  See https://github.com/Recoskie/JDisassembly/blob/master/app.java
  ------------------------------------------------------------*/
  
  var file = new FileReaderV();
  var offset = null, virtual = null, ds = null;
  
  function init()
  {
    offset = new VHex("vhex1", file, false); virtual = new VHex("vhex2", file, true);
    ds = new dataInspector("data", file);
    ds.addEditor(offset); ds.addEditor(virtual);
    
    offset.hide(true); virtual.hide(true); ds.hide(true);
    
    //Open an example file.
    
    file.getFile("https://raw.githubusercontent.com/Recoskie/JDisassembly/master/JD-asm.jar", load);
  }

  //Drag and drop file Support.

  window.addEventListener("dragover",function(e){ (e = e || event).preventDefault(); }, false );
  window.addEventListener("drop",function(e)
  {
    (e = e || event).preventDefault(); if (items = e.dataTransfer.items)
    {
      for( var i = 0; i < items.length; i++ )
      {
        if (items[i].kind === "file") { load(items[i].getAsFile()); i = items.length; }
      }
    }
  }, false );
  
  //Transfers the loaded file to the file input.
  
  function load( f )
  {
    var d = new DataTransfer(); d.items.add(f);
    
    document.getElementById("file").files = d.files;
    
    Open( f );
  }
  
  //When opening an file.
  
  function Open( f )
  {
    offset.hide(false);
    
    show("c1"); show("c2"); show("c3"); show("c4");
    
    file.setTarget( f );
    
    offset.adjSize(); offset.sc(); showD();
  }
  
  //Hex editor show and hide.
  
  function showH(v)
  {
    if( v ) { virtual.hide(virtual.visible); } else { offset.hide(offset.visible); }
    
    document.getElementById(v ? "c3" : "c2").value = "Show " + (v ? "Virtual" : "Offset");
    
    adjHeight()
  }
  
  function showD()
  {
    ds.hide(ds.visible);
    
    document.getElementById("c4").value = (ds.visible ? "Hide " : "Show ") + "data types";
    
    adjHeight();
  }
  
  function adjHeight()
  {
    document.getElementById("vhex1").style.height=document.getElementById("vhex2").style.height=document.getElementById("data").style.height=(100 / (offset.visible + virtual.visible + ds.visible)) + "%";
    
    //Update componets based on visibility.
    
    if( offset.visible ) { offset.update(file); offset.adjSize(); offset.sc(); }
    
    if( virtual.visible ) { virtual.update(file); virtual.adjSize(); virtual.sc(); }
  }
  
  //Show hidden elements.
  
  function show( el )
  {
    document.getElementById(el).style.display = "";
  }
</script>
<input type="file" id="file" onchange="Open(this.files[0]);" /><input type="button" id="c1" value="Hide text" onclick="if(offset.text){offset.setText(false);virtual.setText(false);this.value='Show text';}else{offset.setText(true);virtual.setText(true);this.value='Hide text';};offset.update(file);virtual.update(file);" style="display:none;" /><input type="button" id="c2" value="Hide Offset" onclick="showH(false);" style="display:none;" /><input type="button" id="c3" value="Show Virtual" onclick="showH(true);" style="display:none;" />
<input type="button" id="c4" value="Show Data Types" onclick="showD();" style="display:none;" />
<div style='width:100%;height:100%;border-style:solid;border-color:black;border-width:2px;' id="vhex1"></div>
<div style='width:100%;border-style:solid;border-color:black;border-width:2px;' id="vhex2"></div>
<div style='width:100%;border-style:solid;border-color:black;border-width:2px;' id="data"></div>
</body>
</html>